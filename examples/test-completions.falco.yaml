# Test file for completions
# This file tests various completion scenarios

# Test 1: Top-level completions
# Type "- r" and you should see: rule, required_engine_version, required_plugin_versions


# Test 2: Custom lists
- list: suspicious_binaries
  items:
    - bash
    - sh
    - nc

- list: sensitive_files
  items:
    - /etc/passwd
    - /etc/shadow

# Test 3: Custom macros
- macro: spawned_process
  condition: evt.type = execve

- macro: container_context
  condition: container.id != host

# Test 4: Rule with custom macro and list references
- rule: Suspicious Process in Container
  desc: Detects suspicious process execution in containers
  condition: spawned_process and container_context and proc.name in (suspicious_binaries)
  output: "Suspicious process in container (proc=%proc.name container=%container.id)"
  priority: WARNING
  source: syscall
  tags: [container, security]

# Test 5: Rule with different source
- rule: K8s Suspicious Activity
  desc: Detects suspicious Kubernetes audit events
  condition: ka.verb = delete
  output: "K8s resource deleted (user=%ka.user.name resource=%ka.target.resource)"
  priority: CRITICAL
  source: k8s_audit
  tags: [k8s, security]

# Test 6: Incomplete rule for testing completions
- rule: Test Completions
  desc: Test various completion scenarios
  condition: 
  # ^ Type here to test condition completions (fields, operators, macros, lists)
  output: 
  # ^ Type here to test output completions (fields with %)
  priority: 
  # ^ Type here to test priority completions (EMERGENCY, ALERT, etc.)
  source: 
  # ^ Type here to test source completions (syscall, k8s_audit, aws_cloudtrail, etc.)
  tags: 
  # ^ Type here to test tags completions

