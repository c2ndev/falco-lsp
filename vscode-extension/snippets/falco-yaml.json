{
  "Skip If Unknown Filter": {
    "prefix": "skip-if-unknown-filter",
    "body": "skip-if-unknown-filter: ${1|true,false|}$0",
    "description": "Skip rule if filter fields are unknown (Falco Rules)"
  },
  "Condition: Container": {
    "prefix": "container.id",
    "body": "container.id != host",
    "description": "Check if running inside a container"
  },
  "Condition: Spawned Process": {
    "prefix": "spawned_process",
    "body": "spawned_process and ${1:condition}",
    "description": "Detect process execution with additional conditions"
  },
  "Condition: Open File": {
    "prefix": "open_read",
    "body": "open_read and fd.name ${1|=,startswith,endswith,contains|} ${2:path}",
    "description": "Detect file read operations"
  },
  "Output: Process Info": {
    "prefix": "output-process",
    "body": "proc.name=%proc.name proc.cmdline=%proc.cmdline user.name=%user.name container.id=%container.id",
    "description": "Process details for alert output"
  },
  "Output: File Info": {
    "prefix": "output-file",
    "body": "file=%fd.name proc.name=%proc.name user.name=%user.name",
    "description": "File operation details for alert output"
  },
  "Output: Network Info": {
    "prefix": "output-network",
    "body": "fd.name=%fd.name fd.sip=%fd.sip fd.sport=%fd.sport proc.name=%proc.name",
    "description": "Network connection details for alert output"
  },
  "Tag: MITRE ATT&CK": {
    "prefix": "mitre",
    "body": "${1|T1059,T1055,T1105,T1003,T1070,T1082,T1190,T1068,T1548|}.${2:technique}",
    "description": "MITRE ATT&CK technique identifier"
  },
  "Tags: Common": {
    "prefix": "tags-common",
    "body": "[${1|container,network,process,filesystem,host,k8s,aws,mitre_execution,mitre_persistence,mitre_privilege_escalation,mitre_defense_evasion,mitre_credential_access,mitre_discovery,mitre_lateral_movement,mitre_collection,mitre_exfiltration|}]",
    "description": "Common categorization tags"
  }
}